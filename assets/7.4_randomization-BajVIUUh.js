import{p as I}from"./p5.min-BSfcF2sv.js";import{T as S,S as L}from"./index-BGeJOtze.js";import{i as b,a as R,b as p}from"./index.es-BqIYh0BY.js";import{G as W,r as $}from"./sketch_utils-Cd7mJY-m.js";import{L as q}from"./Loop-BIzYltV2.js";import{P as G}from"./Pattern-AvYLfnE9.js";const H=t=>{let z=-10,f=!1,u,w=[0,2,4,6],o=w,d,k,x,i,c={mixup:T,rotateLeft:v,rotateRight:C,invert:y,mutate:N,tempo:120,reset:D};t.setup=()=>{t.createCanvas(t.windowWidth,t.windowHeight),i=new W,i.add(c,"mixup").name("Shuffle"),i.add(c,"rotateLeft").name("Rotate left"),i.add(c,"rotateRight").name("Rotate right"),i.add(c,"invert").name("Invert"),i.add(c,"mutate").name("Mutate"),i.add(c,"tempo",30,240,1).name("Tempo").onChange(O),i.add(c,"reset").name("Reset"),i.width=200,i.close(),u=b.get("C4 major").notes},t.windowResized=()=>{t.resizeCanvas(t.windowWidth,t.windowHeight)},t.draw=()=>{if(f){t.background(0,25),t.fill(255),t.noStroke(),t.textAlign(t.LEFT,t.BOTTOM),t.textSize(25),t.push();for(let n of o)t.text(n,20,30),t.translate(25,0);t.pop();let e=t.height/20;t.fill(255),t.noStroke(),t.textAlign(t.CENTER,t.CENTER),t.textSize(e),t.translate(t.width/2,t.height/2);for(let n=0;n<u.length;n++){let l=t.map(n,0,u.length,-t.PI/2,t.TWO_PI-t.PI/2),m=t.height/3,r=t.cos(l)*m,a=t.sin(l)*m,h=p.pitchClass(u[n]);h==p.pitchClass(x.currentNote)&&(t.stroke(0,128,255),t.line(r,a,0,0),t.fill(0),t.circle(r,a,e*3)),h==p.pitchClass(k.currentNote)&&(t.stroke(128,255,0),t.line(r,a,0,0),t.fill(0),t.circle(r,a,e*2.5)),h==p.pitchClass(d.currentNote)&&(t.stroke(255),t.line(r,a,0,0),t.fill(0),t.circle(r,a,e*2)),t.noStroke(),t.fill(255),t.text(h,r,a)}t.text(d.currentNote,0,0)}else t.background(0),t.fill(255),t.noStroke(),t.textAlign(t.CENTER),t.text("Click to start sound",t.width/2,t.height/2)},t.mousePressed=()=>{f||(f=!0,P())},t.keyPressed=()=>{o=o.reverse()};function E(e,n){let l=n.length,m=A(e,l),r=n[m],h=p.octave(n[0])+t.floor(e/l);return p.pitchClass(r)+h}function P(){d=new s({}),k=new s({transpose:4,noteDuration:"8n",tempo:"8n."}),x=new s({transpose:-7,noteDuration:"1n",tempo:"1n"}),new q(n=>{let l=[y,N,v,C,T];t.random(l)()},"2m").start("+2m"),S.start()}function A(e,n){return(e%n+n)%n}class s{constructor({transpose:n=0,noteDuration:l="8n",tempo:m="8n",patternType:r="up"}){this.noteDuration=l,this.tempo=m,this.patternType=r,this.transpose=n,this.synth=new L,this.synth.toDestination(),this.synth.volume.value=z,this.pattern=new G((a,h)=>{let g=E(o[h]+this.transpose,u);this.synth.triggerAttackRelease(g,this.noteDuration,a),this.currentNote=g},Array.from(o.keys()),this.patternType),this.pattern.interval=this.tempo,this.pattern.start()}}function T(){t.shuffle(o,!0)}function v(){o=R.rotate(1,o)}function C(){o=R.rotate(-1,o)}function y(){o=o.map(e=>u.length-e)}function N(){let e=t.floor(t.random(o.length));t.random(1)<.5?o[e]++:o[e]--}function O(e){S.bpm.value=e}function D(){$(i),o=w}};new I(H);
